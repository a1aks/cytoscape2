Welcome  to the New Cytoscape Build Process
--------------------------------------------

I.  Doing a Clean Checkout
==========================

If this is the first time reading this, make sure that you have done a clean checkout.  
You will need to have subversion installed (http://subversion.tigris.org).

Then, do a clean check-out:

svn checkout file:///cellar/common/svn/cytoscape/trunk cytoscape 


II.  New Directory Structure
============================

Cytoscape now contains the following directory structure:


cytoscape
   +
   +---resources/ Contains various files used to compile or run cytoscape,
   +              e.g. shell scripts, annotation files, props files etc.
   +
   +---build/     This directoy is automatically generated by Ant.  After compilation,
   +              this directory will contain all generated class files.
   +
   +---images/    Contains image files.
   +
   +---lib/       Contains all JAR files.
   +
   +---src/       Contains all source .java files.
   +
   +---testData/  Contains all test and sample data.
   +
   +---tools/     Contains misc. tools for cytoscape distribution.
   +
   +---docs/      Contains all user documentation and manuals.
   +
   +---plugins/   Contains all core plugins.
   +
   +---licences/  Contains all third party licenses. 
   +
   +---help/      Contains all javahelp files and images. 


III. New Build Process
======================

To build cytoscape:

1.  Download and install Jakarta Ant.  Download from:  http://ant.apache.org/.  
Installation instructions are available at:  http://ant.apache.org/manual/install.html.

2.  To compile cytoscape, type:

	ant all

3.  To run cytoscape, type:

	ant run

If cytoscape appears, everything is set up correctly!

For questions, email Mike Smoot:  msmoot@ucsd.edu 


IV.  Doing a Full Cytoscape Release
===================================

This section contains notes / tasks for doing a full Cytoscape release.  Doing a full release
of Cytoscape is rather involved.  Some of the tasks are automated and some are manual.

	Core Release Tasks
	-------------------
	Setup.
		Depending on whether you're creating a release from the trunk or from
		a release branch you should do fresh checkouts of cytoscape, corelibs,
		and core plugins

		mkdir release
		cd release
		svn co svn+ssh://grenache.ucsd.edu/cellar/common/svn/cytoscape trunk cytoscape
		svn co svn+ssh://grenache.ucsd.edu/cellar/common/svn/corelibs trunk corelibs
		svn co svn+ssh://grenache.ucsd.edu/cellar/common/svn/coreplugins trunk coreplugins

	Compile the core libraries and copy jars to the cytoscape dir.

		cd corelibs
		ant all
		cp build/*.jar ../cytoscape/lib/.

	Compile Cytoscape with new libraries.  This creates the cytoscape.jar file
	needed by coreplugins to compile.

		cd ../cytoscape
		ant all

	Compile core plugins with new cytoscape.jar and copy jars to cytoscape
	dir.

		cd ../coreplugins
		ant all
		cp build/*.jar ../cytoscape/plugins/core/.

	Modify the Cytoscape Version Number in build.xml
		The ant build.xml file contains a property that looks like this:

		<property name="version.num" value="2.6.0"/>

		Note that the version.num property can't contain any alphabetic
		characters.  If you want to create a beta release, append text to
		the "version" property like so:

		<property name="version" value="${version.num}-beta1"/>

	Ensure that the Cytoscape Manual is up-to-date.  See the
	DOC_GENERATION_README.txt file in the "docs" subdir for details.  
	The manual really only needs to be updated for major releases and is more than a
	little bit of a hassle.

	Recompile cytoscape.

		ant all

	Once cytoscape compiles cleanly with the new corelibs, coreplugins, and
	possibly updated documentation, TEST the thing!!!  At a minimum start
	cytoscape and load a session file and play around with a network. 

	Ok, so now you've got cytoscape compiling and running with the latest
	coreplugins and corelibs, so commit the new plugins and libs:

		cd cytoscape
		svn commit -m "commiting new libs and plugins for release 2.x"

	Now tag the cytoscape, coreplugins, and corelibs releases. It is important
	that coreplugins and corelibs get tagged at the same time as cytoscape so
	that these releases can be recreated in the future.  The tag convention we 
	have adopted looks like this:  "Cyto-2.5.2". Please follow this convention.

		To tag the release:

		svn copy \
		  svn+ssh://grenache.ucsd.edu/cellar/common/svn/cytoscape/branches/cy-release-branch-x \
		  file://grenache.ucsd.edu/cellar/common/svn/cytoscape/tags/cyto_version

		svn copy \
		  svn+ssh://grenache.ucsd.edu/cellar/common/svn/coreplugins/branches/cy-release-branch-x \
		  file://grenache.ucsd.edu/cellar/common/svn/coreplugins/tags/cyto_version

		svn copy \
		  svn+ssh://grenache.ucsd.edu/cellar/common/svn/corelibs/branches/cy-release-branch-x \
		  file://grenache.ucsd.edu/cellar/common/svn/corelibs/tags/cyto_version

	Create the final release files
		To do so, run:  

			ant dist

		The final release files are all placed in cytoscape/build/dist,
		including the Javadoc API files.

		NOTE: The installation bundles are created using install4j.  You
		will need install4j installed on your machine and you must
		have the environment variable INSTALL4J_HOME set and pointing
		to the location of the install4j install.

	Deploy the new release files.
		Copy all files to their release directory on the distribution
		server.  Currently this is chianti.ucsd.edu and each release
		lives in a subdirectory of /var/www/html.  

		The subdirectory *MUST* be named correctly for PHP on the website to
		work, like:

			Cyto-2_5_2
			 or
			Cyto-2_6-beta


	Update Cytocape.org Web Site
	----------------------------

		svn co file:///cellar/common/svn/cyto_web/trunk cyto_web

	Make sure the Cytoscape Manual (PDF) is Up-to-Date
		We currently keep a copy of CytoscapeX_YManual.pdf checked into
		two places:  cytscape/user_docs and cyto_web/manual.  cytoscape/user_docs is
		the definitive one, and cyto_web/manual is the copy.

		Before doing a full release, make sure to copy the latest manual from
		cytoscape/user_docs to cyto_web/manual, and check in the latest version.

	Update cyto_web/config.php

		This file contains global configurations for cytoscape.org
		You will need to add variable links for the newly released 
		version of Cytoscape.

	Update cyto_web/index.php with an announcement for the new release.  See
	what we've done for past releases.  Major release should list the major
	new features and minor releases should have smaller announcements.

	Deploy Everything to cytoscape.org
		To do so, update cyto_web/cyto.properties with a valid user/password (If you don't 
		have one, email Mike) Then, type:  
		
			ant deploy


	Tell the world!
	----------------------------
	Send an email announcement to the cytoscape-discuss and cytoscape-announce
	mailing lists.  Include a link to the new release downloads.
