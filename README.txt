Welcome  to the New Cytoscape Build Process
--------------------------------------------

Alpha Tag:
cytocvs tag Cytoscape2_alpha_2004_4_29

Post C21 tag:
cytocvs tag Cytoscape2_alpha_2004_5_19

I.  Doing a Clean Checkout
==========================

If this is the first time reading this, make sure that you have done a clean checkout.  To
do this, create a backup of your local installation of cytoscape.  Then, set your CVSROOT environment
variable to point to:  /common/cvsdir5.

Then, do a clean check-out:

cvs checkout -P cytoscape

II.  New Directory Structure
============================

Cytoscape now contains the following directory structure:

cytoscape
   +
   +---bin/       Contains all OS specific scripts, e.g. shell scripts and batch files.
   +
   +---build/     This directoy is automatically generated by Ant.  After compilation,
   +              this directory will contain all generated class files.
   +
   +---config/    Contains all configuration files, e.g. cytoscape.props.
   +
   +---cytodocs/  Contains all technical documentation.
   +
   +---dist/      This directory is automatically generated by Ant.  After compilation,
   +              this directory will contain cytoscape.jar.
   +
   +---images/    Contains image files
   +
   +---legacy/    Contains legacy files which will no longer be supported.
   +
   +---lib/       Contains all JAR files.
   +
   +---src/       Contains all source .java files.
   +
   +---testData/  Contains all test data
   +
   +---tools/     Contains misc. tools for cytoscape distribution.
   +
   +---user_docs/ Contains all user documentation and manuals.

III. New Build Process
======================

To build cytoscape:

1.  Download and install Jakarta Ant.  Download from:  http://ant.apache.org/.  Installation instructions
are available at:  http://ant.apache.org/manual/install.html.

2.  To compile cytoscape, type:

ant

3.  To run cytoscape, type:

ant run

If cytoscape appears, everything is set up correctly!

For questions, email Ethan Cerami:  cerami@cbio.mskcc.org.

IV.  Building Cytoscape Plug-Ins
================================

Cytoscape plug-ins are expected to have their own ant build.xml files that can be used to
build JAR files for each plugin.  Also, cytoscape/plugins contains stable plugins that are
made available with the official Cytoscape release.

For old Cytoscape 1.1 plug-ins, you might have to follow these directions:

The csplugins directory uses the same build process as before.  To compile csplugins,
you therefore need to do the following:

define your java CLASSPATH to include at least

    <full-path-to-current-directory>/build/classes
    <full-path-to-immediate-parent-directory>

then, cd to csplugins, and type:

  make

V.  Doing a Full Cytoscape Release
===================================

This section contains notes / tasks for doing a full Cytoscape release.  Doing a full release
of Cytoscape is rather involved.  Some of the tasks are automated and some are manual.

	A.  Core Release Tasks
	----------------------------
	Modify the Cytoscape Version Number in build.xml
		The ant build.xml file contains a property that looks like this:

		<property name="version" value="2.0ALPHA4"/>

		The value of this property is very important as it is used to create
		the final release files.  For example, the final release file for 2.0ALPHA4 will
		be cytoscape-v2.0ALPHA4.tar.gz.

		Update this value to the current version number.

	Tag the Complete Release
		The tag convention we have adopted looks like this:  "cyto-2_0-alpha4".
		Please follow this convention.

		To tag a release:

		cvs tag cyto-2_0-alpha4

	Create the final release files
		To do so, run:  ant zip_release

		The final release files are all placed in cytoscape/zip_release.

		This includes two files:
			a.  a binary .tar.gz file (for Linux / Mac OS X)
			b.  a binary .zip file (for Windows)

	To generate the source distribution, run:  ant source

	Deploy the new release files.
		Currently, we are hosting the release files on cbio.mskcc.org only.
		Release files are located in /var/www/cytoscape/release.

		Obviously, only MSKCC people can perform this task.

	B.  Creating the Mac OS X Release
	---------------------------------------
	To create the Mac OS X Specific Release:
	
		1.  run ant task:  ant mac
		
		Doing so will create a directory called Cytoscape.app.
		It will be located in build/cytoscape-vX.Y.
		
		2.  Create a Mac OS X Disk Image File (.dmg)
			--  this is done manually via the Mac Disk Utility program.
			--  in Disk Utility, click "New Image", specify the name 
				"cytoscape-vX.Y", and select 40 MB.
			--  once the image is created on your desktop, copy 
				the complete contents of build/cytoscape-vX.Y to the image.
		3.  Modify the default image for the Cytoscape folder to use the Cytoscape 
			Icon
			--  to do so, go to the disk image:  cytoscape-vX.Y/cytoscape.app, 
			click "Get Info", and expand the tab labeled, "General".
			--  select the icon, and hit Apple-C (Copy)
			--  go to the disk image:  cytoscape-vX.Y, click "Get Info", 
			and expand the tab labeled,	"General".
			--  select the icon, and hit Apple-V (Paste)
		4.  create the dmg.zip file
			--  to do so, right click on cytoscape-vX.Y.dmg, and 
			select "Create Archive".  (Note:  When you created the disk image via
			Disk Utility, it creates two items:  1)  the actual .dmg file;  and
			2) the opened dmg file, displayed as a disk icon.  To create the
			archive, right click on the actual .dmg file, not the disk icon.)

	Deploy the new release file
		As in the section above, we are currently hosting the release files on
		cbio.mskcc.org only.  Release files are located in /var/www/cytoscape/release.

	C.  Creating the InstallAnywhere Release
	-------------------------------------------------

	ISB currently handles this step, and hosts the InstallAnywhere release.  Rowan
	may want to add details to this section.

	D.  Update Cytocape.org Web Site
	-------------------------------------------------

	Make sure Cytoscape 2.0 Manual (PDF) is Up-to-Date
		We currently keep a copy of Cytoscape2_0Manual.pdf checked into
		two places:  cytscape/user_docs and cyto_web/manual.  cytoscape/user_docs is
		the definitive one, and cyto_web/manual is the copy.

		Before doing a full release, make sure to copy the latest manual from
		cytoscape/user_docs to cyto_web/manual, and check in the latest version.

	Update cyto_web/config.php

		This file contains global configurations for cytoscape.org
		You will probably need to add variable links for the newly released 
		version of Cytoscape.

	Deploy Everything to cytoscape.org
		To do so, update cyto_web/cyto.properties with a valid user/password.
		If you don't have one, email Trey or Ethan.

		Then, type:  ant deploy.

	Copy over the latest Javadocs.
		Latest Javadocs are currently hosted on cbio.mkscc.org, and are not part
		of cytoscape.org.  That's mainly because cytoscape.org FTP connection is so slow.

		First, copy over the source code from the task framework.  We want the API for
		this framework to be included in the global 2.1 Javadoc, and this is the easiest
		way to do it.  The code is currently located in
		csplugins/common/task/src/cytoscape/task.  In the future, we should probably
		come up with an automated way of doing this.
		
		Second, run:  ant doc.

		Then, tar/gzip everything in the API directory.

		scp the gzip file to /var/www/cytoscape/javadoc and unpack.

	
